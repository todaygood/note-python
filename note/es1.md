
# doc 

1. Kibana 是一个开源分析和可视化平台，旨在可视化操作 Elasticsearch 。Kibana可以用来搜索，查看，和存储在 Elasticsearch 索引中的数据进行交互。
可以轻松地进行高级数据分析，并可在各种图表，表格和地图中显示数据。

Kibana 可以轻松理解海量数据。其简单的基于浏览器的界面使您能够快速创建和共享动态仪表板，实时显示 Elasticsearch 查询的更改。
Kibana安装简单快速，不需要代码，也不需要需额外的基础架构，就可以和Elasticsearch直接交互 。


2. kibana image 

These images contain both free and subscription features. Start a 30-day trial to try out all of the features.
https://www.elastic.co/guide/en/kibana/current/docker.html#environment-variable-config

一般来说：Kibana一开始连接Elasticsearch，Elasticsearch中有数据有索引，Kibana在匹配索引模式会自动获取Elasticsearch中的索引名

3. kibana中使用SQL查询
在一般的应用场景下，使用sql查询会让学习曲线陡降，特别是结合dev tools，简单快捷优美。

POST /_sql?format=txt
{
  "query": "SELECT * FROM real_time_alpha where date='20210629' order by updateTime desc limit 1 "
}

Elasticsearch支持SQL查询

Kibana主要需要学会使用各种控件，当前主要是表格。下面是一些注意事项：

首先需要针对你的index，建立index pattern，要不然后面的dashboard无法搜索到。
为了时间正常显示，在高级设置里，可以选择当前的时区。
可以设置显示的刷新时间，最好符合自己的数据刷新频率。
 




# 最佳实践

直接在网站找docker-compose.yml , 省得组件对接，花费时间去trouble-shooting.

docker使用 --restart unless-stopped更好一些。
docker update命令 https://docs.docker.com/engine/reference/commandline/update/



# kibana 使用过程中的问题:


https://www.elastic.co/guide/en/kibana/current/windows.html


http://pcentos.hujun.com:9200 发现直接报错，而使用   https://pcentos.hujun.com:9200  弹出了窗口要求输入用户名和密码

使用如下命令reset 密码

```bash
[root@pcentos ~]# docker exec -it elasticsearch  /usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic
This tool will reset the password of the [elastic] user to an autogenerated value.
The password will be printed in the console.
Please confirm that you would like to continue [y/N]y


Password for the [elastic] user successfully reset.
New value: lB8*kwLVd3=Vmra_b3sz
[root@pcentos ~]# 
```

然后in chrome  https://pcentos.hujun.com:9200  得到：

{
  "name" : "dfefa6fdce68",
  "cluster_name" : "docker-cluster",
  "cluster_uuid" : "8EvKajsbQnma0mw781oNzQ",
  "version" : {
    "number" : "8.1.3",
    "build_flavor" : "default",
    "build_type" : "docker",
    "build_hash" : "39afaa3c0fe7db4869a161985e240bd7182d7a07",
    "build_date" : "2022-04-19T08:13:25.444693396Z",
    "build_snapshot" : false,
    "lucene_version" : "9.0.0",
    "minimum_wire_compatibility_version" : "7.17.0",
    "minimum_index_compatibility_version" : "7.0.0"
  },
  "tagline" : "You Know, for Search"
}

[root@pcentos ~]# docker exec -it elasticsearch /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana
eyJ2ZXIiOiI4LjEuMyIsImFkciI6WyIxNzIuMTcuMC41OjkyMDAiXSwiZmdyIjoiMTQ2ZDYxNzc3MDkwMTJkNTRiYjJhNjJkNjViMmYxZmMyMzdlZDg0NTBhMmE0N2M0NGRlZmYxN2Y2MmQzZmIwMSIsImtleSI6IlpNLTJoNEFCb3IwQmtxYzZyMjhTOjZRaF9sOWdFUWhxc2RuUGNMQVdkYmcifQ==



# docker重载配置文件的方法

services:
  kibana:
    image: docker.elastic.co/kibana/kibana:6.0.0
    volumes:
      - ./kibana.yml:/usr/share/kibana/config/kibana.yml

环境变量配置： https://www.elastic.co/guide/cn/kibana/current/docker.html
 